#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <unistd.h>
#include <pthread.h>
#include <fcntl.h>
#include <string.h>
#include <sys/types.h>
#include <sys/stat.h>

int lire_char(int fichier){
	char c;
	return read(fichier, &c, 1) ?c : EOF;
}


int modifier_char(int c, int valeur_modif, int sens){ //sens defini si on encode(1) ou on decode (0)
	if( c != EOF ){
		if(c == ' ' || c ==',' || c == '?'|| c == '.' || c == ';' || c == ':' || c == '/'
			|| c == '!' || c == '*' || c =='\''){ 
		return c;
		}

		else if(sens == 0){ sens = -1;}
		
		return c = ( (c + sens*valeur_modif) % 128);
	}
	return c;
}

void creer_fichier_modifie(char *fichier1, char *fichier2, int valeur_modif, int sens){
	int tmp = EOF;
	int fic1, fic2;
	
	fic1 = open(fichier1, O_RDWR);
	fic2 = open(fichier2, O_CREAT | O_RDWR);
	
	while( (tmp = modifier_char( lire_char(fic1), valeur_modif, sens ) ) != EOF){
		write(fic2, &tmp, 1);
	}
	
	close(fic1);
	close(fic2);
}



int main(){
	int fic;
	fic = open("texte.txt", O_RDONLY);
	int c[6];
	int i;
	for(i=0; i<6; i++){
		c[i] = lire_char(fic);
		printf("%c\n", c[i]);
	}

	close(fic);

	//creer_fichier_modifie("teste.txt", "texte.txt", 2, 1);
}